<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Follow the Prophet | Primary Song Activities</title>
        <meta name="description" content="Activity page for the Primary song Follow the Prophet">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta property="og:image" content="https://ethyl2.github.io/primary-song-activities/images/prophet/daniel.jpeg">
        <meta property="og:url" content="https://ethyl2.github.io/primary-song-activities/follow-the-prophet.html">
        <meta property="og:title" content="Follow the Prophet | Primary Song Activities">
        <meta property="og:description" content="Activity page for the Primary song Follow the Prophet">
        <meta property="og:type" content="website" />
        <link rel="icon" type="image/x-icon" href="favicon.ico?">
        <link rel="apple-touch-icon" sizes="180x180" href="https://ethyl2.github.io/primary-song-activities/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://ethyl2.github.io/primary-song-activities/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://ethyl2.github.io/primary-song-activities/favicon-16x16.png">
        <link rel="manifest" href="https://ethyl2.github.io/primary-song-activities/site.webmanifest">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Mali&display=swap" rel="stylesheet">
        <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    </head>
    <body class="bg-black text-white min-h-screen" style="font-family: 'Mali', cursive;">
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <header class="sticky z-50 bg-gradient-to-b from-red-400 to-yellow-700 py-4 md:py-12">
            <h1 class="z-50 text-bold text-lg md:text-3xl text-center font-bold pb-2">Follow the Prophet</h1>
            <h2 class="z-50 text-semibold text-base md:text-2xl text-center px-2">Guess the words and phrases from the song</h2>
        </header>
        <main class="flex flex-col items-center justify-center space-y-3 py-8 mx-auto">
            <audio controls class="z-50 mb-4">
                <source src="./audio/prophet.mp3" type="audio/mp3">
                Your browser does not support the audio element.
            </audio>

            <button type="button" onclick="getWord()" class="rounded-3xl px-2 py-4 border-2 font-semibold hover:bg-gray-800">Get a word or phrase</button>
            <div id="word-container" class="pt-4 flex flex-wrap justify-center"></div>
            <p id="message" class="h-10"></p>
            <div id="alphabet-container" class="opacity-0 w-full grid grid-cols-7 gap-2 md:w-1/2 px-3"></div>
            <div id="rainbow" class="rounded overflow-hidden flex items-center justify-center border border-gray-500 mb-4"></div>
            <div class="rounded overflow-hidden h-32 flex items-center justify-center w-full sm:h-48">
                <img id="current-img" class="h-full rounded" src="./images/prophet/which-prophet.png" />
            </div>

        </main>
        <footer class="z-50 h-96 w-full bg-gradient-to-b from-yellow-500 to-red-900 flex flex-col space-y-2 items-center justify-start pt-2 md:pt-4">
            <div class="flex items-center justify-center space-x-3 z-50">
                <a
                href="https://ethyl2.github.io/primary-song-activities/"
                title="back to home"
                class="bg-white p-px rounded hover:bg-green-400"
            >
                <img src="./images/home.png" alt="music note" class="rounded w-7 h-7 md:w-10 md:h-10" />
                <span class="sr-only">Back to Home</span>
            </a>
                <a
                href="https://www.churchofjesuschrist.org/music/library/childrens-songbook/follow-the-prophet"
                target="_blank"
                title="sheet music"
                class="bg-white p-px rounded hover:bg-yellow-400"
            >
                <img src="./images/music-note-icon.png" alt="music note" class="w-7 h-7 md:w-10 md:h-10" />
                <span class="sr-only">Link to Sheet Music</span>
            </a>

            <a  href="https://github.com/ethyl2/primary-song-activities"
                target="_blank"
                rel="noopener noreferrer"
                class="p-px rounded bg-white hover:bg-red-400"
                title="link to GitHub repository"
            >
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" class="w-7 h-7 md:w-10 md:h-10"
                focusable="false" width="1.73em" height="1.5em" style="
                                    -ms-transform: rotate(360deg);
                                    -webkit-transform: rotate(360deg);
                                    transform: rotate(360deg);
                                " preserveAspectRatio="xMidYMid meet" viewBox="0 0 1227.825 1000">
                <path
                    d="M1078.94-.985c-33.192-.491-110.295 10.777-239.027 96.936c-70.161-17.535-144.812-26.188-219.591-26.188c-82.278 0-165.425 10.448-242.965 31.719C192.534-24.605 110.955 1.234 110.955 1.234c-53.258 133.183-20.347 231.788-10.344 256.277C38.014 325.069-.2 411.338-.2 517.07c0 79.822 9.085 151.416 31.281 213.653c1.231 4.803.832 3.732 2.906 7.844c4.89 12.884 10.327 25.39 16.438 37.468c2.094 4.346 4 7.563 4 7.563c62.395 116.307 185.396 191.438 404.244 215.028l330.995.375c233.392-23.144 345.386-98.499 396.994-215.591l3.281-7.625c4.89-11.828 9.153-24.135 20.813-65.562c11.659-41.427 16.875-113.172 16.875-193.185c0-114.755-43.1-206.577-113.092-276.434c12.231-39.48 28.57-127.158-16.313-239.402c0 0-6.293-1.995-19.281-2.188zM818.1 420.133c53.893-.117 100.057 9.136 134.717 45.499v.031c43.369 45.541 68.749 100.525 68.749 159.778c0 276.658-177.932 284.183-397.4 284.183c-219.506 0-397.4-38.336-397.4-284.183c0-58.861 25.009-113.516 67.843-158.872c71.451-75.59 192.365-35.562 329.558-35.562c70.423-.011 136.564-10.75 193.935-10.875zm-408.807 81.468c-45.666 0-82.687 61.741-82.687 137.936c0 76.206 37.019 137.967 82.687 137.967c45.666 0 82.687-61.761 82.687-137.967c0-76.184-37.019-137.881-82.687-137.936zm443.649 0c-45.666 0-82.687 61.741-82.687 137.936c0 76.206 37.019 137.967 82.687 137.967c45.666 0 82.687-61.761 82.687-137.967c0-76.184-37.019-137.881-82.687-137.936z"
                    fill="black" />
                </svg>
                <span class="sr-only">GitHub Repo</span>
            </a>
            </div>

            <p class="z-50 text-center text-sm md:text-base">Copyright <span id="current-year">2021</span> <a href="https://github.com/ethyl2" target="_blank" class="hover:underline">Heather Nuffer</a></p>
        </footer>
        <script type="text/javascript">
            const currentYearSpan = document.getElementById('current-year')
            currentYearSpan.textContent = new Date().getFullYear()

            const messageEl = document.getElementById('message')
            const imgEl = document.getElementById('current-img')

            // Create the alphabet grid
            const alpha = Array.from(Array(26)).map((e, i) => i + 65)
            const alphabet = alpha.map((x) => String.fromCharCode(x))
            const alphabetContainerEl = document.getElementById('alphabet-container')
            alphabet.forEach(letter => {
                const letterEl = document.createElement('button')
                letterEl.textContent = letter
                letterEl.classList.add('border-2', 'rounded-xl', 'px-1', 'py-2', 'hover:bg-gray-800')
                letterEl.setAttribute('data-letter', letter)
                letterEl.addEventListener('click', handleClick)
                alphabetContainerEl.append(letterEl)
            })

            // Create the rainbow element
            const rainbowEl = document.getElementById('rainbow')
            const colors = ['#002E96', '#80198C', '#BA0072', '#DB2950', '#E55D2C', '#DB8D00', '#BFB800']
            colors.forEach(color => {
                const colorEl = document.createElement('div')
                colorEl.classList.add('w-10', 'h-10', 'md:w-20', 'md:h-20', 'rainbow-color')
                colorEl.style.backgroundColor = color
                rainbowEl.append(colorEl)
            })

            const words = [
                // Verse 1: Adam
                {solution: 'Adam', imgUrl: 'adam-served-the-lord.jpeg'},
                {solution: 'Eden', imgUrl: 'eden.jpeg'},
                {solution: 'descendants', imgUrl: 'adam-served-the-lord.jpeg'},
                {solution: 'served the Lord', imgUrl: 'adam-served-the-lord.jpeg'},
                {solution: 'following his ways', imgUrl: 'adam-served-the-lord.jpeg'},
                {solution: 'he helped things to grow', imgUrl: 'eden.jpeg'},
                {solution: 'latter days', imgUrl: 'adam-served-the-lord.jpeg'},

                // Verse 2: Enoch
                {solution: 'Enoch', imgUrl: 'enoch-follow-the-prophet.jpeg'},
                {solution: 'righteous', imgUrl: 'enoch-live-with-him.jpeg'},
                {solution: 'live with him', imgUrl: 'enoch-live-with-him.jpeg'},

                // Verse 3: Noah
                {solution: 'Noah', imgUrl: 'noah-repentance.jpeg'},
                {solution: 'nobody heard', imgUrl: 'noah-repentance.jpeg'},
                {solution: 'repentance', imgUrl: 'noah-repentance.jpeg'},
                {solution: 'rain', imgUrl: 'noah-ark.jpeg'},
                {solution:  'preach the word', imgUrl: 'noah-repentance.jpeg'},

                // Verse 4: Abraham
                {solution: 'Abraham', imgUrl: 'abraham-and-sarah.jpeg'},
                {solution: 'Isaac', imgUrl: 'isaac.jpeg'},
                {solution: 'chosen one', imgUrl: 'isaac-chosen-one.jpeg'},
                {solution: 'Abraham the prophet', imgUrl: 'abraham-and-sarah.jpeg'},
                {solution: 'twelve tribes', imgUrl: 'jacobs-sons.jpeg'},
                {solution: 'the Bible tells', imgUrl: 'jacobs-sons.jpeg'},
                {solution: 'the Lord sent Isaac', imgUrl: 'isaac-chosen-one.jpeg'},
                {solution: 'Jacob', imgUrl: 'jacob.jpeg'},
                {solution: 'Israel', imgUrl: 'israel.jpeg'},
                {solution: 'Bible', imgUrl: 'israel.jpeg'},
                {solution: 'chosen', imgUrl: 'isaac-chosen-one.jpeg'},

                // Verse 5: Moses
                {solution: 'Moses', imgUrl: 'moses-commandments.jpeg'},
                {solution: 'sent to Israel', imgUrl: 'moses-led.jpeg'},
                {solution: 'promised land', imgUrl: 'moses-part-water.jpeg'},
                {solution: 'wilderness', imgUrl: 'moses-wilderness.jpeg'},
                {solution: 'forty years', imgUrl: 'moses-wilderness2.jpeg'},


                // Verse 6: Samuel
                {solution: 'Samuel', imgUrl: 'samuel-the-prophet.jpeg'},
                {solution: 'Hannah', imgUrl: 'hannah.jpeg'},
                {solution: 'Hannah promised', imgUrl: 'hannah-promised.jpeg'},
                {solution: 'joy', imgUrl: 'hannah-promised.jpeg'},
                {solution: 'serve with joy', imgUrl: 'hannah-promised.jpeg'},
                {solution: 'Here I am', imgUrl: 'samuel-here-i-am.jpeg'},
                {solution: 'Samuel heard', imgUrl: 'samuel-here-i-am.jpeg'},
                {solution: 'tabernacle', imgUrl: 'samuel-here-i-am.jpeg'},
                {solution: 'called by God', imgUrl: 'samuel-here-i-am.jpeg'},

                // Verse 7: Jonah
                {solution: 'Jonah', imgUrl: 'jonah-the-prophet.jpeg'},
                {solution: 'whale', imgUrl: 'jonah-and-whale.jpeg'},
                {solution: 'really try', imgUrl: 'jonah-repentant.jpeg'},
                {solution: 'listen and obey', imgUrl: 'jonah-out-of-whale.jpeg'},

                // Verse 8: Daniel
                {solution: 'Daniel', imgUrl: 'daniel-refused-to-sin.jpeg'},
                {solution: 'king threw Daniel', imgUrl: 'daniel-king-threw.jpeg'},
                {solution: 'calmed the lions', imgUrl: 'daniel-safe.jpeg'},
                {solution: 'king soon saw', imgUrl: 'daniel-king-soon-saw.jpeg'},
                {solution: 'power was great', imgUrl: 'daniel-king-soon-saw.jpeg'},
                {solution: 'lions', imgUrl: 'daniel-safe.jpeg'},
                {solution: 'refused to sin', imgUrl: 'daniel-refused-to-sin.jpeg'},
                {solution: 'angels', imgUrl: 'daniel-safe.jpeg'},

                // Verse 9: Today
                {solution: 'get direction', imgUrl: 'president-nelson.jpeg'},
                {solution: 'watch the news', imgUrl: 'president-nelson.jpeg'},

                // Chorus
                {solution: 'Follow the prophet', imgUrl: 'president-nelson.jpeg'},
                {solution: 'He knows the way', imgUrl: 'president-nelson.jpeg'},
                {solution: 'heed the prophets', imgUrl: 'president-nelson.jpeg'},
            ]
            const wordContainerEl = document.getElementById('word-container')
            let newWord = ''
            let letters = []
            let errorsCount = 0

            function getWord() {
                // Clear the message
                messageEl.textContent = ''

                // Reset the alphabet grid
                alphabetContainerEl.classList.remove('opacity-0')
                const alphabetButtons = document.querySelector('#alphabet-container').childNodes
                alphabetButtons.forEach(button => {
                    button.classList.remove('bg-green-600', 'bg-red-600', 'cursor-not-allowed')
                    button.disabled = false
                })

                // Reset the rainbow
                errorsCount = 0
                const colorEls = rainbowEl.childNodes
                colorEls.forEach(colorEl => {
                    colorEl.classList.remove('opacity-0')
                })

                // Remove the old word/phrase
                const letterHolders = document.querySelectorAll('.letter-holder')
                letterHolders.forEach(letterHolder => {
                    letterHolder.remove()
                })

                // Get a new word/phrase
                newWord = words[Math.floor(Math.random() * words.length)]
                letters = newWord.solution.toUpperCase().split('')
                imgEl.src = `./images/prophet/which-prophet.png`
                imgEl.alt = 'guess'
                letters.forEach(letter => {
                    const letterEl = document.createElement('span')

                    if (letter !== ' ') {
                    letterEl.textContent = '__'
                    } else {
                        letterEl.classList.add('w-4', 'h-4')
                    }
                    letterEl.classList.add('px-2', 'letter-holder', 'md:text-xl')
                    letterEl.setAttribute('data-letter', letter)
                    wordContainerEl.append(letterEl)
                })

            }

            // Handle alphabet grid click
            function handleClick(e) {
                const letterButton = e.target
                letterButton.disabled = true
                letterButton.classList.add('cursor-not-allowed')
                const letter = letterButton.getAttribute('data-letter')
                const indices = getAllIndices(letters, letter)
                if (indices.length > 0) {
                    letterButton.classList.add('bg-green-600')
                    const letterHolders = document.querySelectorAll('.letter-holder')
                    indices.forEach(index => {
                        letterHolders[index].textContent = letter
                    })
                    // Show the success message if all the letters are guessed correctly
                    if (Array.from(letterHolders).filter(element => element.textContent === '__').length === 0) {
                        messageEl.textContent = "You figured it out! Congratulations!"
                        imgEl.src = `./images/prophet/${newWord.imgUrl}`
                        imgEl.alt = newWord.solution
                    }
                } else {
                    letterButton.classList.add('bg-red-600')
                    if (errorsCount < 7) {
                        Array.from(document.querySelectorAll('.rainbow-color'))[errorsCount].classList.add('opacity-0')
                        errorsCount++
                    }
                }
            }

            function getAllIndices(arr, val) {
                let indexes = [], i
                for(i = 0; i < arr.length; i++) {
                    if (arr[i] === val) {
                        indexes.push(i)
                    }
                }
                return indexes;
            }
        </script>
    </body>
</html>
